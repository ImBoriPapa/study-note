# 빌더패턴과 정적 팩토리 메서드 패턴의 활용

## 1. 문제
- 회원 엔티티 생성로직 구현
- 회원 엔티티의 생성시 필요한 필드가 약 15개가 필요함.
- 회원 엔티티의 생성시 이메일 가입과 Oauth2 가입의 구분이 필요함.

## 2. 사실수집: 
1. 5개 이상의 필드를 정의해야할때 지저분한 코드
2. 생성하는 객체의 구분이 힘듬
3. 가독성이 낮다

## 3. 원인추론: 
- new 키워드로 객체를 생성시 단점

## 4. 조사방법 결정:
- 생성자가 아닌 빌더패턴으로 가독성 항샹
- 정적 팩토리 메서드 패턴을 사용해서 의미있는 메서드의 이름을 사용

## 5. 조사방법 구현:
```java
@Entity
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
@EqualsAndHashCode(of = {"id"})
@Table(name = "member", indexes = {
        @Index(name = "MEMBER_EMAIL_IDX", columnList = "email"),
        @Index(name = "MEMBER_CONTACT_IDX", columnList = "contact"),
        @Index(name = "MEMBER_CREATE_DATE_TIME_IDX", columnList = "date_index")
})
public class Member {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "member_id")
    private Long id;
    @Column(name = "authentication_code", unique = true, nullable = false)
    private String authenticationCode;
    @Column(name = "oauth_id", nullable = true)
    private String oauthId;
    @Column(name = "email", nullable = false)
    private String email;
    @OneToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL, orphanRemoval = true)
    @JoinColumn(name = "member_profile_id")
    private MemberProfile memberProfile;
    @Enumerated(EnumType.STRING)
    @Column(name = "registration_type")
    private RegistrationType registrationType;
    @Column(name = "password")
    private String password;
    @Column(name = "contact")
    private String contact;
    @Column(name = "authority", nullable = false)
    @Enumerated(EnumType.STRING)
    private Authority authority;
    @Column(name = "ip_address")
    private String ipAddress;
    @Column(name = "account_status")
    @Enumerated(EnumType.STRING)
    private AccountStatus accountStatus;
    @Column(name = "created_at")
    private LocalDateTime createdAt;
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;
    @Column(name = "deleted_at")
    private LocalDateTime deletedAt;
    @Column(name = "date_index")
    private Long dateIndex;

    @Builder(access = AccessLevel.PROTECTED)
    protected Member(String oauthId, RegistrationType registrationType, String email, String password, String contact, Authority authority, String ipAddress, AccountStatus accountStatus, LocalDateTime createdAt, LocalDateTime updatedAt, LocalDateTime deletedAt) {
        this.oauthId = oauthId;
        this.registrationType = registrationType;
        this.email = email;
        this.password = password;
        this.contact = contact;
        this.authority = authority;
        this.ipAddress = ipAddress;
        this.accountStatus = accountStatus;
        this.createdAt = createdAt;
        this.updatedAt = updatedAt;
        this.deletedAt = deletedAt;
    }

    public static Member createWithEmail(String email, String password, String contact) {

        final LocalDateTime createdAt = LocalDateTime.now();

        Member member = Member.builder()
                .email(email)
                .oauthId(null)
                .password(password)
                .registrationType(RegistrationType.BAD_REQUEST)
                .contact(contact)
                .authority(Authority.MEMBER)
                .accountStatus(AccountStatus.ACTIVE)
                .createdAt(createdAt)
                .updatedAt(createdAt)
                .deletedAt(createdAt)
                .build();

        member.generateDateTimeIndex();
        member.generateAuthenticationCode();

        return member;
    }

    public static Member createWithOauth2(String email, String oauthId, RegistrationType registrationType) {

        final LocalDateTime createdAt = LocalDateTime.now();

        Member member = Member.builder()
                .email(email)
                .oauthId(oauthId)
                .password(null)
                .registrationType(registrationType)
                .contact(null)
                .authority(Authority.MEMBER)
                .accountStatus(AccountStatus.ACTIVE)
                .createdAt(createdAt)
                .updatedAt(createdAt)
                .deletedAt(createdAt)
                .build();

        member.generateDateTimeIndex();
        member.generateAuthenticationCode();

        return member;
    }

```

## 6. 결과 관찰:
test code

## 7. 문서 작성


